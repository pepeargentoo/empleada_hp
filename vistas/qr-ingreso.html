<!doctype html>
<html lang="en">
  <head>
  	<title>Empleada</title>
    <meta charset="utf-8">
   
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

	<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="../css/style.css">
    <script src="../js/jquery.min.js"></script>
  	<script src="../js/popper.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/main.js"></script>
    <script src="../js/html5-qrcode.min.js"></script>
    
</head>
	<body>
	<section class="ftco-section">
		<div class="container">
			<div class="row justify-content-center">
				<div class="col-md-6 col-lg-5">
					<div class="login-wrap p-4 p-md-5">
		      	<div class="icon d-flex align-items-center justify-content-center">
		      		<span class="fa fa-user-o"></span>
		      	</div>
		      	<h3 class="text-center mb-4">Ingresar</h3>
				<div class="col-md-12">
                    <div id="reader" class="reader"></div>
                    <div id="scanned-result"></div>
                </div>
                

	        </div>
				</div>
			</div>
		</div>
	</section>
	<script>
        function docReady(fn)
          {
           
            if (document.readyState === "complete" || document.readyState === "interactive") {
                  setTimeout(fn, 1);
              }
            else
             {
              document.addEventListener("DOMContentLoaded", fn);
             }
         }
        function mostraQr(codeId, decodedText, decodedResult)
          {
              let resultSection = document.getElementById('scanned-result');
              let tableBodyId = "scanned-result-table-body";
              if (!document.getElementById(tableBodyId)) {
                  let table = document.createElement("table");
                  table.className = "styled-table";
                  table.style.width = "100%";
                  resultSection.appendChild(table);
                  let theader = document.createElement('thead');
                  let trow = document.createElement('tr');
                  let th1 = document.createElement('th');
                  th1.innerText = "conteo";
                  let th2 = document.createElement('th');
                  th2.innerText = "Formato";
                  let th3 = document.createElement('th');
                  th3.innerText = "Resultado";
                  trow.appendChild(th1);
                  trow.appendChild(th2);
                  trow.appendChild(th3);
                  theader.appendChild(trow);
                  table.appendChild(theader);
                  let tbody = document.createElement("tbody");
                  tbody.id = tableBodyId;
                  table.appendChild(tbody);
      
        }
      
              let tbody = document.getElementById(tableBodyId);
              let trow = document.createElement('tr');
              let td1 = document.createElement('td');
              td1.innerText = `${codeId}`;
              let td2 = document.createElement('td');
              td2.innerText = `${decodedResult.result.format.formatName}`;
              let td3 = document.createElement('td');
              td3.innerText = `${decodedText}`;
              trow.appendChild(td1);
              trow.appendChild(td2);
              trow.appendChild(td3);
              tbody.appendChild(trow);
      
          
        }
        docReady(function() {
              // Este el verdadero codigo de interes
              var lastMessage;
              var codeId = 0;
              function onScanSuccess(decodedText, decodedResult) {
              // y decodedText() es el heroe de la pelicula
                      if (lastMessage !== decodedText) {
                              lastMessage = decodedText;
                  mostrarQr(codeId, decodedText, decodedResult);
                  ++codeId;
                      }
              }
              let html5QrcodeScanner = new Html5QrcodeScanner(
              "reader",
              {
                  fps: 10,
                  qrbox: 250,
      
                  experimentalFeatures: {
                      useBarCodeDetectorIfSupported: true
                  }
              });
              html5QrcodeScanner.render(onScanSuccess);
      });
      
      
      </script>
    
</body>
</html> 